test_begin("Records");

// Basic record
record Point(x, y);
define p = Point(3, 4);
test("accessor x", 3, p->x);
test("accessor y", 4, p->y);

// Predicate
test("predicate true", true, Point?(p));
test("predicate false", false, Point?(42));

// Multiple record types
record Pair(a, b);
define pr = Pair(10, 20);
test("Pair a", 10, pr->a);
test("Pair b", 20, pr->b);
test("Pair? true", true, Pair?(pr));
test("Pair? false for Point", false, Pair?(p));
test("Point? false for Pair", false, Point?(pr));

// Record with different value types
record Entry(key, value);
define e = Entry("name", 42);
test("string field", "name", e->key);
test("int field", 42, e->value);

// Unknown field raises error
test("unknown field error", true,
    try { p->z; false; } catch(err) true);

test_end();
